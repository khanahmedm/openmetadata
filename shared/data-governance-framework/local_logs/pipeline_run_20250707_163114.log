{"time": "2025-07-07 16:31:14,899", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "3994885461", "msg": "Notebook started"}
{"time": "2025-07-07 16:31:14,911", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "config_loader", "msg": "ConfigLoader initialized for target table: genome"}
{"time": "2025-07-07 16:31:14,912", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "config_loader", "msg": "Resolved config path: s3a://cdm-lake/config-json/genome.json"}
{"time": "2025-07-07 16:31:14,913", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "config_loader", "msg": "Loading config from MinIO: bucket=cdm-lake, key=config-json/genome.json"}
{"time": "2025-07-07 16:31:15,146", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "config_loader", "msg": "Config loaded successfully from MinIO"}
{"time": "2025-07-07 16:31:15,147", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "config_loader", "msg": "All required fields are present in the config"}
{"time": "2025-07-07 16:31:15,148", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "config_loader", "msg": "Target table: pangenome.genome"}
{"time": "2025-07-07 16:31:15,447", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "spark_session", "msg": "Found 4 JARs in /home/jovyan/jars"}
{"time": "2025-07-07 16:31:15,448", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "spark_session", "msg": "JARs: ['/home/jovyan/jars/aws-java-sdk-bundle-1.12.367.jar', '/home/jovyan/jars/delta-core_2.12-2.4.0.jar', '/home/jovyan/jars/delta-storage-2.4.0.jar', '/home/jovyan/jars/hadoop-aws-3.3.4.jar']"}
{"time": "2025-07-07 16:31:15,449", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "spark_session", "msg": "Starting Spark session..."}
{"time": "2025-07-07 16:31:19,913", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "spark_session", "msg": "Spark session started successfully"}
{"time": "2025-07-07 16:31:19,926", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "config_loader", "msg": "Input files: [{'source': 'GTDB', 'file_path': 's3a://cdm-lake/bronze/gtdb/sp_clusters_r214.tsv', 'file_type': 'tsv', 'delimiter': '\t', 'ignore_first_line': 'no'}, {'source': 'NCBI', 'file_path': 's3a://cdm-lake/bronze/ncbi/assembly_summary_genbank.txt', 'file_type': 'tsv', 'delimiter': '\t', 'ignore_first_line': 'yes'}]"}
{"time": "2025-07-07 16:31:19,927", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "input_file_validator", "msg": "Starting input file validation..."}
{"time": "2025-07-07 16:31:19,934", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "input_file_validator", "msg": "Checking file: s3a://cdm-lake/bronze/gtdb/sp_clusters_r214.tsv"}
{"time": "2025-07-07 16:31:19,944", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "input_file_validator", "msg": "File exists: s3://cdm-lake/bronze/gtdb/sp_clusters_r214.tsv"}
{"time": "2025-07-07 16:31:20,079", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 1: Tab-delimited"}
{"time": "2025-07-07 16:31:20,080", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 2: Tab-delimited"}
{"time": "2025-07-07 16:31:20,080", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 3: Tab-delimited"}
{"time": "2025-07-07 16:31:20,081", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 4: Tab-delimited"}
{"time": "2025-07-07 16:31:20,081", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 5: Tab-delimited"}
{"time": "2025-07-07 16:31:20,082", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "input_file_validator", "msg": "Checking file: s3a://cdm-lake/bronze/ncbi/assembly_summary_genbank.txt"}
{"time": "2025-07-07 16:31:20,088", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "input_file_validator", "msg": "File exists: s3://cdm-lake/bronze/ncbi/assembly_summary_genbank.txt"}
{"time": "2025-07-07 16:32:08,608", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 2: Tab-delimited"}
{"time": "2025-07-07 16:32:08,697", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 3: Tab-delimited"}
{"time": "2025-07-07 16:32:08,701", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 4: Tab-delimited"}
{"time": "2025-07-07 16:32:08,704", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 5: Tab-delimited"}
{"time": "2025-07-07 16:32:08,705", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "input_file_validator", "msg": "Line 6: Tab-delimited"}
{"time": "2025-07-07 16:32:19,513", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "Starting schema vs. file validation"}
{"time": "2025-07-07 16:32:19,646", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "config_loader", "msg": "Output file: {'output_file_path': 's3a://cdm-lake/pangenome-source/table_genome_V1.1.tsv', 'file_type': 'tsv', 'delimiter': '\t', 'ignore_first_line': 'no'}"}
{"time": "2025-07-07 16:32:19,649", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "Output file: s3a://cdm-lake/pangenome-source/table_genome_V1.1.tsv"}
{"time": "2025-07-07 16:32:19,649", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "validate_schema", "msg": "Delimiter: 	, Ignore first line: False"}
{"time": "2025-07-07 16:32:20,322", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "Header columns successfully extracted from output file"}
{"time": "2025-07-07 16:32:20,324", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "validate_schema", "msg": "Header columns: ['genome_id', 'gtdb_species_clade_id', 'gtdb_taxonomy_id', 'ncbi_biosample_id', 'fna_file_path_nersc', 'faa_file_path_nersc']"}
{"time": "2025-07-07 16:32:20,324", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "config_loader", "msg": "Schema file path: s3a://cdm-lake/schemas/pangenome-schema.yaml"}
{"time": "2025-07-07 16:32:20,325", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "Schema file: s3a://cdm-lake/schemas/pangenome-schema.yaml"}
{"time": "2025-07-07 16:32:20,392", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "Schema loaded successfully"}
{"time": "2025-07-07 16:32:20,393", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "validate_schema", "msg": "Schema columns: ['genome_id', 'gtdb_taxonomy_id', 'gtdb_species_clade_id', 'ncbi_biosample_id', 'fna_file_path_nersc', 'faa_file_path_nersc']"}
{"time": "2025-07-07 16:32:20,394", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "Comparison between schema and file header completed"}
{"time": "2025-07-07 16:32:20,395", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "All schema columns are present in the file"}
{"time": "2025-07-07 16:32:20,396", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "validate_schema", "msg": "No extra columns in the file"}
{"time": "2025-07-07 16:32:20,423", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "config_loader", "msg": "Output file: {'output_file_path': 's3a://cdm-lake/pangenome-source/table_genome_V1.1.tsv', 'file_type': 'tsv', 'delimiter': '\t', 'ignore_first_line': 'no'}"}
{"time": "2025-07-07 16:32:20,424", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "run_validations", "msg": "Starting validation on file: s3a://cdm-lake/pangenome-source/table_genome_V1.1.tsv"}
{"time": "2025-07-07 16:32:20,425", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "run_validations", "msg": "Delimiter: 	, Ignore first line: False"}
{"time": "2025-07-07 16:32:20,426", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "config_loader", "msg": "Validations: [{'column': 'genome_id', 'validation_type': 'not_null', 'error_message': 'Missing genome_id'}, {'column': 'genome_id', 'validation_type': 'regex_match', 'pattern': '^[A-Za-z0-9_.-]+$', 'error_message': 'Invalid genome_id format'}, {'column': 'gtdb_taxonomy_id', 'validation_type': 'not_null', 'error_message': 'Missing taxonomy ID'}, {'column': 'gtdb_species_clade_id', 'validation_type': 'not_null', 'error_message': 'Missing species clade ID'}]"}
{"time": "2025-07-07 16:32:20,426", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "run_validations", "msg": "Validation rules: [{'column': 'genome_id', 'validation_type': 'not_null', 'error_message': 'Missing genome_id'}, {'column': 'genome_id', 'validation_type': 'regex_match', 'pattern': '^[A-Za-z0-9_.-]+$', 'error_message': 'Invalid genome_id format'}, {'column': 'gtdb_taxonomy_id', 'validation_type': 'not_null', 'error_message': 'Missing taxonomy ID'}, {'column': 'gtdb_species_clade_id', 'validation_type': 'not_null', 'error_message': 'Missing species clade ID'}]"}
{"time": "2025-07-07 16:32:23,023", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "run_validations", "msg": "Running validations..."}
{"time": "2025-07-07 16:32:23,024", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "DEBUG", "module": "run_validations", "msg": "Header columns: ['genome_id', 'gtdb_species_clade_id', 'gtdb_taxonomy_id', 'ncbi_biosample_id', 'fna_file_path_nersc', 'faa_file_path_nersc']"}
{"time": "2025-07-07 16:32:23,445", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "run_validations", "msg": "Validation summary:"}
{"time": "2025-07-07 16:32:23,446", "pipeline": "pangenome", "schema": "pangenome", "table": "genome", "level": "INFO", "module": "run_validations", "msg": "All validation rules passed. No issues found."}
